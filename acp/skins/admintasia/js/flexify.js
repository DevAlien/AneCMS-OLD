/**
 * Flexify 1.1 | jQuery Plugin
 *
 * Copyright (c) 2008 Tim Cameron Ryan
 * http://plugins.jquery.com/project/Flexify
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
 
(function(f){f.fn.flexify=function(){var j=this.add(this.find("*")),h={},k={};f.each(["horizontal","vertical"],function(m,n){h[n]=j.filter(function(){return f(this).data("flexify-parent")&&f(this).data("flexify-parent").axes[n]});k[n]=j.filter(function(){return f(this).data("flexify-position")&&f(this).data("flexify-position").axes[n]})});var l=this;function i(){h.horizontal.flexifyDimensions("horizontal");k.horizontal.flexifyPosition("horizontal");var m=l.dimension("horizontal");h.vertical.flexifyDimensions("vertical");k.vertical.flexifyPosition("vertical");if(m<l.dimension("horizontal")){return i()}f(window).one("reflow",i)}i();return this};f.fn.flexifyDimensions=function(k){for(var m=this.length-1,o=this[m];m>-1;o=this[--m]){var l=f(o).data("flexify-parent"),p=[0];l.children[k].each(function q(){var i=f(this).data("flexify-child");for(var s in i.properties[k]){f(this).css(s,0)}if(i.dimensions.hasOwnProperty(k)){f(this).dimension(k,"content",i.intrinsic[k]);p.push((parseInt(i.intrinsic[k])||f(this).dimension(k,"content"))/i.dimensions[k])}});l.flexUnit=Math.max.apply(null,p);l.children[k].each(function n(){var i=f(this).data("flexify-child");for(var s in i.properties[k]){f(this).css(s,l.flexUnit*i.properties[k][s])}if(i.dimensions.hasOwnProperty(k)){f(this).dimension(k,"content",l.flexUnit*i.dimensions[k])}});f(o).trigger("FlexifyReset",[k])}for(var m=0,o=this[m];m<this.length;o=this[++m]){var l=f(o).data("flexify-parent");var j=f(o).dimension(k,"content"),h;if(k==f(o).flow()){h=f(o).contentDimension(k,"offset")}l.children[k].each(function r(s,w){if(k!=f(o).flow()){h=f(this).dimension(k,"border")}var t=f(this).data("flexify-child");var v=l.flexUnit+Math.max(Math.floor((j-h)/(k==f(o).flow()?l.childDivisor[k]:t.divisor[k])),0);for(var u in t.properties[k]){f(this).css(u,v*t.properties[k][u])}if(t.dimensions.hasOwnProperty(k)){f(this).dimension(k,"content",v*t.dimensions[k])}});f(o).trigger("FlexifyApply",[k])}return this};f.fn.flexifyPosition=function(k){for(var h=0,p=this[h],j;h<this.length;p=this[++h]){if(!(j=p.offsetParent)){return}var m=f(p).data("flexify-position"),o=0;for(var l in m.properties[k]){o+=m.properties[k][l]}var n=Math.max((f(j).dimension(k,"border")-f(p).dimension(k,"border"))/o,0);for(var l in m.properties[k]){f(p).css(l,m.properties[k][l]*n)}}return this};f.fn.flex=function(n,m){n=n.replace(/^(border-[a-z]+)$/,"$1-width");var h={horizontal:"margin-left|margin-right|border-left-width|border-right-width|padding-left|padding-right|width|left|right".split("|"),vertical:"margin-top|margin-bottom|border-top-width|border-bottom-width|padding-top|padding-bottom|height|top|bottom".split("|")};var l="left|right|top|bottom".split("|");var i="width|height".split("|");for(var j in h){if(f.inArray(n,h[j])!=-1){break}}if(f.inArray(n,h[j])==-1){return false}if(arguments.length<2){return f.inArray(n,i)!=-1?f(this).data("flexify-child").dimensions[j]:f.inArray(n,l)!=-1?f(this).data("flexify-position")[j][n]:f(this).data("flexify-child").properties[j][n]}if(f.inArray(n,l)!=-1){return this.each(function(o,p){if(!f(this).data("flexify-position")){f(this).data("flexify-position",{properties:{horizontal:{},vertical:{}},axes:{horizontal:false,vertical:false}})}f(this).data("flexify-position").axes[j]=true;f(this).data("flexify-position").properties[j][n]=m})}var k=f.browser.msie?"html":f.browser.opera&&f.browser.version<9.5?"html, body":"";return this.not(k).each(function(p,q){if(!f(this).parent().flow()){f(this).parent().flow("vertical")}if(!f(this).parent().data("flexify-parent")){f(this).parent().data("flexify-parent",{flexUnit:0,children:{horizontal:f([]),vertical:f([])},childDivisor:{horizontal:0,vertical:0},axes:{horizontal:false,vertical:false}})}if(!f(this).data("flexify-child")){f(this).data("flexify-child",{divisor:{horizontal:0,vertical:0},intrinsic:{horizontal:null,vertical:null},properties:{horizontal:{},vertical:{}},dimensions:{}})}f(this).data("flexify-child").divisor[j]+=m;f(this).parent().data("flexify-parent").childDivisor[j]+=m;f(this).parent().data("flexify-parent").axes[j]=true;f(this).parent().data("flexify-parent").children[j]=f(this).parent().data("flexify-parent").children[j].add(this);if(n=="width"||n=="height"){f(this).data("flexify-child").dimensions[j]=m;f(this).data("flexify-child").intrinsic[j]=this.style[n];if(f.browser.opera&&f.browser.version<9.5&&f(this).is(":button, input, textarea, iframe")){f(this).data("flexify-child").intrinsic[j]=f(this).dimension(j)}}else{f(this).data("flexify-child").properties[j][n]=m}var o=f(this).add(f(this).parents());f(this).parent().unbind("FlexifyReset.setMinimums").one("FlexifyReset.setMinimums",function(s,r){if(r=="horizontal"){o.trigger("ResetFlow")}})})};function a(k,j,h){return f(k).data("flexify-child")}f.extend(f.expr[":"],{flexible:a});var d,e;function c(){var h=d!=f(window).dimension("horizontal")||e!=f(window).dimension("vertical");d=f(window).dimension("horizontal");e=f(window).dimension("vertical");return h}f(function(){c();setInterval(function(){if(c()){f(window).trigger("reflow")}},250)});f.fn.flow=function b(h){if(arguments.length<1){return this.data("flow")}return this.each(function(j,k){f(this).data("flow",h=="horizontal"?"horizontal":"vertical");for(var m=this.firstChild;m;m=m.nextSibling){if(m.nodeType==3){/^\s+$/.test(m.nodeValue)?this.removeChild(m):f(m).wrap('<div class="text"></div>')}}f(this).children().css("zoom",1);if(h=="horizontal"){var l=f([]);f(this).children().each(function(){if(!f(this).is(":button")&&f(this).dimensionIsAuto(h)){f(this).dimension(h,"content",f(this).css("overflow")=="auto"?0:f(this).contentDimension(h,"scroll"))}});f(this).css(f.browser.msie?{zoom:1}:{overflow:"auto"});f(this).children().css({"float":"left"});f(this).bind("ResetFlow",function(){f.swap(this,{width:"10000px"},function(){f(this).dimension(h,"min",f(this).contentDimension(h,"offset")+1)})}).trigger("ResetFlow")}})};function g(k,j,h){return f(k).data("flow")==h[2]}f.extend(f.expr[":"],{vertical:g,horizontal:g});(function(){function i(m,l){return parseFloat(f.curCSS(m,l,true))||0}var k={horizontal:"Width",vertical:"Height"},h={horizontal:"Left",vertical:"Top"},j={horizontal:"Right",vertical:"Bottom"};f.fn.dimension=function(l,o,n){if(!this.length){return null}var m=this[0];o=o||"content";if(m==window||m==document){return(document.compatMode=="CSS1Compat"?document.documentElement:document.body)["client"+k[l]]}if(n==undefined){if(o=="margin"||o=="border"){n=m["offset"+k[l]]+(o=="margin"?i(m,"margin"+h[l])+i(m,"margin"+j[l]):0)}if(o=="padding"||o=="content"){n=m["client"+k[l]]-(o=="content"?i(m,"padding"+h[l])+i(m,"padding"+j[l]):0)}return Math.max(0,Math.ceil(n))}return this[o=="content"?k[l].toLowerCase():o+k[l]](n)};if(f.browser.msie){f(function(){var l=document.documentElement;f.each(["Left","Right","Top","Bottom"],function(m,n){if(l.currentStyle["border"+n+"Style"]!="none"&&l.currentStyle["border"+n+"Width"]=="medium"){l.style["border"+n+"Width"]="2px"}})})}f.fn.contentDimension=function(n,l){if(!this.length){return null}var p=this[0];if(f.browser.msie&&n=="vertical"){return this[0].scrollHeight-(this[0]!=document?i(this[0],"padding"+h[n])-i(this[0],"padding"+j[n]):0)}if(l=="scroll"){var m={"float":"left",border:"2px solid black"},r;m[k[n].toLowerCase()]="1px";f.swap(p,m,function(){r=p["scroll"+k[n]]-i(p,"padding"+h[n])-i(p,"padding"+j[n])});return Math.max(0,Math.ceil(r))}for(var q=p.firstChild;q&&q.nodeType!=1;q=q.nextSibling){}if(!q){return null}for(var o=p.lastChild;o&&o.nodeType!=1;o=o.previousSibling){}return Math.max(0,Math.ceil(i(q,"margin"+h[n])+(o["offset"+h[n]]-q["offset"+h[n]])+o["offset"+k[n]]+i(o,"margin"+j[n])))};f.fn.dimensionIsAuto=function(m){if(!this.length){return}var n=this[0].style["padding"+h[m]];this[0].style["padding"+h[m]]=0;var o=this[0]["offset"+k[m]];this[0].style["padding"+h[m]]="1px";var l=this[0]["offset"+k[m]]==o;this[0].style["padding"+h[m]]=n;return l}})();f.each({Height:"height",Width:"width"},function(h,i){f.fn["min"+h]=function(j){return this.css("min"+h,typeof j=="string"?j:j+"px")}});if(f.browser.msie&&f.browser.version<7){f.each({Height:"height",Width:"width"},function(i,j){f.fn["min"+i]=function(k){return this.each(function(l,m){f(window).bind("reflow.minDimensions",function(){m.runtimeStyle[j]=""});f(this).css("zoom",1).unbind("resize.minDimensions").bind("resize.minDimensions",function(){if(f(this)[j]()<parseInt(k)){this.runtimeStyle[j]=typeof k=="string"?k:k+"px"}}).trigger("resize.minDimensions")})};f(window).one("resize.minDimensions",function h(){f("body").trigger("resize.minDimensions");f(window).one("resize.minDimensions",h)})})}})(jQuery);
